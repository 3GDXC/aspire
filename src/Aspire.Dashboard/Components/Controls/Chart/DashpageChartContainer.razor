@namespace Aspire.Dashboard.Components

@inherits ChartContainer

@using Aspire.Dashboard.Otlp.Model
@using Aspire.Dashboard.Resources
@using Metrics = Aspire.Dashboard.Components.Pages.Metrics
@using Aspire.Dashboard.Components.Controls.Chart

@inject IStringLocalizer<ControlsStrings> Loc

@if (Instrument is null)
{
    <div>@Loc[nameof(ControlsStrings.ChartContainerUnableToDisplay)]</div>
}
else
{
    <div>
        <div class="dashpage-chart-header">
            <h5 style="margin-bottom: 0">@Instrument.Name</h5>
        </div>

        <div class="dashpage-chart-body">
            @if (ActiveView is Metrics.MetricViewKind.Graph)
            {
                <ChartWrapper Applications="@Applications"
                          Duration="@Duration"
                          Instrument="@Instrument"
                          InstrumentViewModel="@ViewModel"
                          DimensionFilters="@DimensionFilters"
                          IsDashpage="true"/>
            }
            else
            {
                <MetricTableWrapper Applications="@Applications"
                                Duration="@Duration"
                                Instrument="@Instrument"
                                InstrumentViewModel="@ViewModel"
                                DimensionFilters="@DimensionFilters"/>
            }
        </div>
    </div>
}

@code {
    [Parameter, EditorRequired]
    public required Metrics.MetricViewKind ActiveView { get; set; }

    [Parameter]
    public required List<OtlpApplication> Applications { get; set; }
}
